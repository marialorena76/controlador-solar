<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Informe Solar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Dosis:wght@400;500;700&family=Bebas+Neue&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles.css?v=prod1">
  <style>
    body {
        background: #f4f7fa;
        font-family: 'Dosis', Arial, sans-serif;
        margin: 0;
        padding: 0;
    }
    .solar-report {
      max-width: 780px;
      margin: 32px auto;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 3px 20px 0 #0002;
      padding: 32px;
    }
    .report-title {
      text-align: center;
      background: #337ab7;
      color: #fff;
      margin: -32px -32px 24px -32px;
      padding: 24px 0;
      font-size: 1.5rem;
      border-radius: 10px 10px 0 0;
      letter-spacing: 0.5px;
      font-family: 'Bebas Neue', Arial, sans-serif;
    }
    .report-section {
        margin-bottom: 32px;
    }
    .section-header {
      background: #e5ecf6;
      color: #337ab7;
      font-weight: bold;
      padding: 8px 12px;
      border-radius: 5px;
      margin-bottom: 15px;
      font-size: 1.2rem;
    }
    .report-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
      font-size: 1.1rem;
    }
    .report-table th,
    .report-table td {
      border: 1px solid #ddd;
      padding: 10px 15px;
      text-align: left;
    }
    .report-table th {
      background-color: #f2f2f2;
      font-weight: bold;
    }
    .result-blue {
      color: #007bff;
      font-weight: bold;
    }
    .result-green {
      color: #28a745;
      font-weight: bold;
    }
    .result-box {
      background-color: #e6f7ff;
      border: 1px solid #b3e0ff;
      padding: 15px;
      border-radius: 8px;
      font-size: 1.2rem;
      font-weight: bold;
      color: #0056b3;
      text-align: center;
      margin-top: 20px;
    }
    .informe-btns {
      text-align: center;
      margin-top: 30px;
    }
    .informe-btn {
      background-color: #28a745;
      color: white;
      padding: 12px 25px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-family: 'Bebas Neue', sans-serif;
      font-size: 1.1rem;
      letter-spacing: 0.5px;
      margin: 0 10px;
      transition: background-color 0.2s ease, transform 0.1s ease;
    }
    .informe-btn:hover {
      background-color: #218838;
      transform: translateY(-1px);
    }

    /* New Economic Result Box Styles */
    .economic-result-box {
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-family: 'Dosis', sans-serif;
    }
    .economic-result-label {
        font-size: 1.1rem;
        flex-grow: 1;
    }
    .economic-result-value {
        font-size: 1.5rem;
        font-weight: bold;
        text-align: right;
    }
    .economic-result-value .currency {
        font-size: 1rem;
        font-weight: normal;
        margin-left: 5px;
    }
    .blue-box {
        background-color: #e7f5ff;
        border-left: 5px solid #007bff;
        color: #004085;
    }
    .gray-box {
        background-color: #f8f9fa;
        border-left: 5px solid #6c757d;
        color: #343a40;
    }
    .yellow-box {
        background-color: #fff3cd;
        border-left: 5px solid #ffc107;
        color: #856404;
    }
    .aclaracion-box {
        background-color: #f1f1f1;
        border: 1px solid #ddd;
        padding: 15px;
        border-radius: 5px;
        font-size: 0.9rem;
        color: #555;
        line-height: 1.4;
        margin-top: 20px;
    }


    /* Estilos para impresión */
    @media print {
      body {
        background-color: #fff;
      }
      .solar-report {
        box-shadow: none;
        border: 1px solid #ccc;
        margin: 0;
        max-width: none;
        padding: 0;
      }
      .informe-btns {
        display: none; /* Oculta los botones en la impresión */
      }
    }
  </style>
</head>
<body>
  <div class="solar-report">
    <div class="report-title" id="report-main-title">
      <!-- Title will be set by JS -->
    </div>

    <!-- Basic User Report Sections -->
    <div id="basic-report-sections">
        <div class="report-section">
          <div class="section-header">• Consumo y generación</div>
          <table class="report-table">
            <tr>
              <td>Consumo anual de energía eléctrica</td>
              <td><span id="basico_consumo_anual_kwh"></span> (kWh/año)</td>
            </tr>
            <tr>
              <td>Generación anual de energía eléctrica</td>
              <td><span id="basico_energia_generada_anual"></span> (kWh/año)</td>
            </tr>
            <tr>
              <td>Energía para autoconsumo</td>
              <td><span id="basico_autoconsumo"></span> (kWh/año)</td>
            </tr>
            <tr>
              <td>Energía inyectada a la red</td>
              <td><span id="basico_inyectada_red"></span> (kWh/año)</td>
            </tr>
          </table>
        </div>
        <div class="report-section">
          <div class="section-header">• Detalles de la instalación</div>
          <table class="report-table">
            <tr>
              <td>Potencia de paneles sugerida</td>
              <td><span id="basico_potencia_panel_sugerida"></span> W</td>
            </tr>
            <tr>
              <td>Cantidad paneles necesarios</td>
              <td><span id="basico_numero_paneles"></span></td>
            </tr>
            <tr>
              <td>Superficie necesaria</td>
              <td><span id="basico_area_paneles_m2"></span> m2</td>
            </tr>
          </table>
        </div>
        <div class="report-section">
            <table class="report-table">
                <tr>
                    <td>Vida útil del proyecto (años)</td>
                    <td><span id="basico_vida_util"></span></td>
                </tr>
            </table>
        </div>
        <div class="report-section">
            <div class="section-header">Resultados económicos</div>

            <div class="economic-result-box blue-box">
                <div class="economic-result-label" id="basico_resultado_label">Si realiza la instalación fotovoltaica su costo anual en energía eléctrica se reducirá a</div>
                <div class="economic-result-value">
                    <span id="basico_costo_reducido"></span>
                    <span class="currency">U$S</span>
                </div>
            </div>

            <div class="economic-result-box gray-box">
                <div class="economic-result-label">Sin la instalación fotovoltaica su gasto anual en energía eléctrica es de</div>
                <div class="economic-result-value">
                    <span id="basico_costo_sin_instalacion"></span>
                    <span class="currency">U$S</span>
                </div>
            </div>

            <div class="economic-result-box yellow-box">
                <div class="economic-result-label">Inversión inicial necesaria para el sistema solar fotovoltaico</div>
                <div class="economic-result-value">
                    <span id="basico_inversion_inicial_total"></span>
                    <span class="currency">U$S</span>
                </div>
            </div>

            <div class="aclaracion-box">
                <strong>ACLARACIÓN:</strong> El análisis ecónomico aquí presentado no considera los costos fijos en la factura de Energía Eléctrica, ya que el costo fijo no variará en caso de realizar la instalación de paneles solares fotovoltaicos.
                Tampoco se consideran los impuestos que pueden llegar a ser entre un 30% y 40% de su factura. Debe considerar que los impuestos en su factura de energía eléctrica disminiurán de llevar adelante la instalación, en particular aquellos que esten ligados al consumo, como por ejemplo el IVA.
            </div>
        </div>
        <div class="report-section">
          <div class="section-header">• Contribución a la mitigación del cambio climático</div>
          <table class="report-table">
            <tr>
              <td>Emisiones de gases de efecto invernadero evitadas con la instalación</td>
              <td><span id="basico_emisiones_total_vida_util"></span> tCO2</td>
            </tr>
          </table>
        </div>

        <!-- Chart Sections -->
        <div class="report-section">
          <div class="section-header">Consumo de energía eléctrica vs generación de energía solar fotovoltaica para un día típico de Invierno</div>
          <div style="width: 100%; margin: auto;"><canvas id="winterDailyChart"></canvas></div>
        </div>
        <div class="report-section">
          <div class="section-header">Consumo de energía eléctrica vs generación de energía solar fotovoltaica para un día típico de Verano</div>
          <div style="width: 100%; margin: auto;"><canvas id="summerDailyChart"></canvas></div>
        </div>
        <div class="report-section">
          <div class="section-header">Comparativa entre consumo de energía eléctrica y generación solar fotovoltaica para cada mes del año</div>
          <div style="width: 100%; margin: auto;"><canvas id="monthlyComparisonChart"></canvas></div>
        </div>
    </div>

    <!-- Expert User Report Sections -->
    <div id="expert-report-sections" style="display: none;">
        <!-- Radiación -->
        <div class="report-section">
            <div class="section-header">• Radiación:</div>
            <table class="report-table">
                <tr>
                    <td>Radiación Anual Incidente:</td>
                    <td><span id="experto_radiacion_anual"></span> kWh/m2/año</td>
                </tr>
                <tr>
                    <td>Incremento respecto de un plano horizontal</td>
                    <td><span id="experto_incremento_radiacion"></span> %</td>
                </tr>
            </table>
        </div>
        <!-- Consumo (similar to basic) -->
        <div class="report-section">
            <div class="section-header">• Consumo:</div>
            <table class="report-table">
                <tr>
                    <td>Consumo anual de energía eléctrica</td>
                    <td><span id="experto_consumo_anual"></span> (kWh/año)</td>
                </tr>
            </table>
        </div>
        <!-- Panel/es -->
        <div class="report-section">
            <div class="section-header">• Panel/es:</div>
            <table class="report-table">
                <tr><td>Marca</td><td><span id="experto_panel_marca"></span></td></tr>
                <tr><td>Potencia</td><td><span id="experto_panel_potencia"></span> W</td></tr>
                <tr><td>Modelo</td><td><span id="experto_panel_modelo"></span></td></tr>
                <tr><td>Eficiencia informada por el fabricante del panel</td><td><span id="experto_panel_eficiencia"></span> %</td></tr>
                <tr><td>Cantidad Paneles Necesarios</td><td><span id="experto_cantidad_paneles"></span></td></tr>
                <tr><td>Superficie necesaria</td><td><span id="experto_superficie"></span> m2</td></tr>
                <tr><td>Potencia Instalada W</td><td><span id="experto_potencia_instalada"></span> W</td></tr>
            </table>
        </div>
        <!-- Inversor/es -->
        <div class="report-section">
            <div class="section-header">• Inversor/es:</div>
            <table class="report-table">
                <tr><td>Inversores sugeridos</td><td><span id="experto_inversor_sugerido"></span></td></tr>
                <tr><td>Potencia</td><td><span id="experto_inversor_potencia"></span> W</td></tr>
                <tr><td>Eficiencia informada por el fabricante del INV.</td><td><span id="experto_inversor_eficiencia"></span> %</td></tr>
                <tr><td>Cantidad de Inversores</td><td><span id="experto_cantidad_inversores"></span></td></tr>
            </table>
        </div>
        <!-- Datos económicos del proyecto -->
        <div class="report-section">
            <div class="section-header">Datos económicos del proyecto:</div>
            <div class="section-header" style="font-size: 1.1rem; background: none; color: #333;">• Resultado económico sin realizar la instalación fotovoltaica</div>
            <table class="report-table">
                <tr><td>CARGO VARIABLE POR ENERGÍA DEMANDADA EN PICO</td><td><span id="experto_moneda_1"></span> <span id="experto_cargo_pico"></span></td></tr>
                <tr><td>CARGO VARIABLE POR ENERGÍA DEMANDADA FUERA DE PICO</td><td><span id="experto_moneda_2"></span> <span id="experto_cargo_fuera_pico"></span></td></tr>
                <tr><td>Costo actual anual en Energía Eléctrica (sin instalación fotovoltaica)</td><td><span id="experto_moneda_3"></span> <span id="experto_costo_actual"></span></td></tr>
                <tr><td>Costo total actualizado del consumo Energía Eléctrica</td><td><span id="experto_moneda_4"></span> <span id="experto_costo_total_actualizado"></span></td></tr>
            </table>
            <div class="section-header" style="font-size: 1.1rem; background: none; color: #333;">• Resultado económico realizando la instalación fotovoltaica</div>
            <table class="report-table">
                <tr><td>Inversión inicial:</td><td><span id="experto_moneda_5"></span> <span id="experto_inversion_inicial"></span></td></tr>
                <tr><td>Costo de mantenimiento por año:</td><td><span id="experto_moneda_6"></span> <span id="experto_mantenimiento"></span></td></tr>
                <tr><td>Tarifa inyección de Energía Eléctrica:</td><td><span id="experto_moneda_7"></span> <span id="experto_tarifa_inyeccion"></span></td></tr>
                <tr><td>Costo futuro de energía eléctrica consumida de la red</td><td><span id="experto_moneda_8"></span> <span id="experto_costo_futuro"></span></td></tr>
                <tr><td>Ahorro total actualizado en energía eléctrica consumida</td><td><span id="experto_moneda_9"></span> <span id="experto_ahorro_actualizado"></span></td></tr>
                <tr><td>Ingreso anual por inyección de energía a la red</td><td><span id="experto_moneda_10"></span> <span id="experto_ingreso_anual_inyeccion"></span></td></tr>
                <tr><td>Ingreso total por inyección de energía a la red actualizado</td><td><span id="experto_moneda_11"></span> <span id="experto_ingreso_total_inyeccion"></span></td></tr>
            </table>
            <div class="section-header" style="font-size: 1.1rem; background: none; color: #333;">Resultado económico actualizado del proyecto</div>
            <table class="report-table">
                <tr><td>Ahorro neto logrado durante la vida util del proyecto</td><td><span id="experto_moneda_12"></span> <span id="experto_ahorro_neto"></span></td></tr>
            </table>
        </div>
        <!-- Emisiones -->
        <div class="report-section">
          <div class="section-header">• Contribución a la mitigación del cambio climático</div>
          <table class="report-table">
            <tr><td>Emisiones de Gases de Efecto Invernadero evitadas</td><td></td></tr>
            <tr><td>Primer Año</td><td><span id="experto_emisiones_primer_ano"></span> Toneladas CO2</td></tr>
            <tr><td>Totales</td><td><span id="experto_emisiones_totales"></span> Toneladas CO2</td></tr>
          </table>
        </div>

        <!-- Chart Sections -->
        <div class="report-section">
            <div class="section-header">Balance Mensual de Energía</div>
            <div style="width: 100%; margin: auto;"><canvas id="monthlyBalanceChart"></canvas></div>
        </div>
        <div class="report-section">
            <div class="section-header">Distribución Estimada de Pérdidas del Sistema</div>
            <div style="width: 60%; margin: auto;"><canvas id="lossDistributionChart"></canvas></div>
        </div>
        <div class="report-section">
            <div class="section-header">Evolución Anual de Consumo y Generación (25 Años)</div>
            <div style="width: 100%; margin: auto;"><canvas id="annualEvolutionChart"></canvas></div>
        </div>
    </div>

    <div class="informe-btns">
      <button class="informe-btn" onclick="window.print()">Imprimir</button>
      <button class="informe-btn" id="descargarPDF">Descargar PDF</button>
      <button class="informe-btn" onclick="window.location.href='index.html'">Volver al Calculador</button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="informe.js?v=prod1"></script>
</body>
</html>